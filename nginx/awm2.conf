server {

    add_header          X-Server-Block  "awm2"; 

    listen              80;
    server_name         awm2.dylancaulfield.ie;

    root /var/www;
    index index.html;

    location / {
        try_files       $uri $uri/ $uri.html /index.html;
    }

    # location /api {
    #     proxy_pass      http://django:8000;
    # }

    # location /static {
    #     proxy_pass      http://django:8000;
    # }

    location ~* \.(?:css|js|jpg|svg)$ {
        expires         30d;
        add_header      Cache-Control "public";
    }

}

server {

    add_header          X-Server-Block  "pgadmin"; 

    listen              80;
    server_name         pgadmin.awm2.dylancaulfield.ie pgadmin.localhost;

    # location / {
    #     proxy_pass      http://pgadmin;
    # }

}

server {

    add_header          X-Server-Block  "localhost"; 

    listen              443 ssl;
    server_name         localhost;

    ssl_certificate     /etc/nginx/pem/mkcert.pem;
    ssl_certificate_key /etc/nginx/pem/mkcert-key.pem;
    ssl_protocols       TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers         HIGH:!aNULL:!MD5;

    location / {
        proxy_pass      http://host.docker.internal:8080; 
        proxy_set_header    Host $host;
    }

    location /api {
        proxy_pass      http://host.docker.internal:8000;
    }

    location /static {
        proxy_pass      http://host.docker.internal:8000;
    }

}
